#!/usr/bin/env bash

# c-basic-offset: 4; tab-width: 4; indent-tabs-mode: t
# vi: set shiftwidth=4 tabstop=4 noexpandtab:
# :indentSize=4:tabSize=4:noTabs=false:

set -o nounset
#set -o errexit
#set -o pipefail

# shellcheck disable=SC1090
source "$HOME/bin/common.bash"

###############################################################################

IFS='\n' read -r -d '' dotadds <<-EOF
    .bash_completion
    .bash_logout
    .bash_profile
    .bashrc
    .bashrc.d/
    .config/asdf-plugin-list    
    .config/dunst/dunstrc
    .config/dunst/dunstrc.d_*
    .config/gtk-2.0/
    .config/gtk-3.0/
    .config/htop/htoprc
    .config/nvim/autoload/
    .config/nvim/init.vim
    .config/pip/
    .config/pulse/daemon.conf
    .config/ranger/
    .config/picom.conf
    .config/sway/
    .config/remmina
    .config/user-dirs.dirs
    .editorconfig
    .gitconfig
    .gitignore.d/dot*
    .i3/
    .local/etc
    .local/share/applications/
    .local/share/bash-completion
    .local/share/doc/
    .local/share/icons/
    .local/man/
    .local/share/nautilus/
    .local/share/nemo/
    .pam_environment
    .pastebinit.xml
    .profile
    .screenlayout
    .screenrc
    .selected_editor
    bin/
EOF

IFS='\n' read -r -d '' dotremoves <<-EOF
EOF
 
IFS='\n' read -r -d '' sdotadds <<-EOF
    .config/gandi/
    .config/mopidy/mopidy.conf
    .aws/
    .cert/
    .config/gandi/
    .config/gcloud/
    .config/gotify/
    .config/hcloud/
    .config/mopidy/
    .config/scw/
    .gitignore.d/sdot*
    .gnupg/
    .kube/config-*.yaml
    .kube/kubie.yaml
    .remmina/
    .s3cfg
    .src/
    .ssh/
    .talos/
    bins/
    etc/
EOF

IFS='\n' read -r -d '' sdotremoves <<-EOF
    .config/gcloud/cache/
    .config/gcloud/logs/
    .config/gcloud/.last*
    .ssh/*_known_hosts
    .ssh/known_hosts*
EOF
 

###############################################################################

cd $HOME

for repo in dot sdot
do
	_entries="${repo}adds"
	for entry in ${!_entries}
	do
	    vcsh run ${repo} git add --force ${entry} ||:
	done
	
	_entries="${repo}removes"
	for entry in ${!_entries}
	do
	    vcsh run ${repo} git rm -r --cached --quiet ${entry} ||:
	done
	
done

